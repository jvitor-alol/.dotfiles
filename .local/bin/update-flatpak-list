#!/bin/bash

# Determine the real user who initiated the action.
# SUDO_USER exists only if the script is executed through sudo.
# logname is used as fallback when SUDO_USER is not available.
REAL_USER="${SUDO_USER:-$(logname)}"

# Resolve the real user's home directory using getent.
REAL_HOME=$(getent passwd "$REAL_USER" | cut -d: -f6)

# Generate the list of installed Flatpak applications
flatpak list --columns=application --app > "$REAL_HOME/flatpaks.txt"
